<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Gerador de Senhas Aleatórias</title>
  <style>
    :root{
      --bg: #f4f7fb;
      --card: #ffffff;
      --accent: #6a8cff;
      --danger: #dc3545;
      --success: #16a34a;
      --muted: #687085;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: Inter,system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(135deg,#000000,#40443d);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:20px;
    }

    .card{
      width:770px;
      max-width:95%;
      background:var(--card);
      border-radius:12px;
      padding:98px;
      box-shadow:0 10px 30px rgba(2,6,23,0.08);
    }

    h1{margin:0 0 10px 0;font-size:50px}
    p.lead{margin:6px 0 16px;color:var(--muted);font-size:14px}

    .output {
      display:flex;
      gap:8px;
      align-items:center;
      margin-bottom:12px;
    }

    #senha {
      flex:1;
      padding:10px 12px;
      font-size:16px;
      border-radius:8px;
      border:1px solid #e6eefc;
      background:#fbfdff;
      color:#0f172a;
      overflow:hidden;
      white-space:nowrap;
      text-overflow:ellipsis;
    }

    .btn {
      padding:10px 12px;
      border-radius:8px;
      border:none;
      cursor:pointer;
      font-weight:600;
    }

    .btn-gera { background: var(--accent); color:white; }
    .btn-copy { background: #eef7ff; color:var(--accent); border:1px solid #dfe8ff; }

    .controls { display:flex; gap:12px; flex-direction:column; }

    .row { display:flex; gap:12px; align-items:center; margin-bottom:10px; }
    label { font-size:14px; color:#243047; }
    input[type="range"] { width:100%; }

    .checkboxes { display:flex; flex-wrap:wrap; gap:10px; }
    .chk { display:flex; gap:8px; align-items:center; padding:8px 10px; border-radius:8px; background:#fbfdff; border:1px solid #eef4ff; }

    .strength {
      height:10px;
      border-radius:6px;
      background:#eef2ff;
      overflow:hidden;
      margin-top:6px;
    }
    .strength > i { display:block; height:100%; width:0%; background:linear-gradient(90deg,#ff6b6b,#ffd166,#6aeb6a); transition:width 250ms ease; }

    .small { font-size:13px; color:var(--muted); margin-top:6px; }

    .footer { display:flex; gap:10px; justify-content:space-between; align-items:center; margin-top:12px; }
    .note { font-size:12px; color:var(--muted); }
    .copied { color: var(--success); font-weight:700; font-size:13px; }
    .error { color: var(--danger); font-weight:700; font-size:13px; }
  </style>
</head>
<body>
  <div class="card" role="region" aria-label="Gerador de senhas aleatórias">
    <h1>Gerador de Senhas</h1>
    <p class="lead">Configure as opções, gere uma senha forte e copie para a área de transferência.</p>

    <div class="output">
      <div id="senha" aria-live="polite" title="Senha gerada">Clique em Gerar</div>
      <button class="btn btn-copy" id="copiarBtn" aria-label="Copiar senha">Copiar</button>
      <button class="btn btn-gera" id="gerarBtn" aria-label="Gerar senha">Gerar</button>
    </div>

    <div class="controls">
      <div class="row" style="align-items:center">
        <label for="tamanho">Tamanho: <strong id="tamanhoValor">16</strong></label>
        <input id="tamanho" type="range" min="6" max="64" value="16" />
      </div>

      <div class="checkboxes" role="group" aria-label="Opções de caracteres">
        <label class="chk"><input type="checkbox" id="maiusculas" checked /> <span>Maiúsculas (A-Z)</span></label>
        <label class="chk"><input type="checkbox" id="minusculas" checked /> <span>Minúsculas (a-z)</span></label>
        <label class="chk"><input type="checkbox" id="numeros" checked /> <span>Números (0-9)</span></label>
        <label class="chk"><input type="checkbox" id="simbolos" checked /> <span>Símbolos (!@#$...)</span></label>
        <label class="chk"><input type="checkbox" id="semAmbiguos" /> <span>Remover ambíguos (0 O l I)</span></label>
      </div>

      <div>
        <div class="small">Força:</div>
        <div class="strength" aria-hidden="true"><i id="barraForca"></i></div>
      </div>
    </div>

    <div class="footer">
      <div class="note">Não compartilhe suas senhas. Use um gerenciador de senhas para armazenamento seguro.</div>
      <div id="feedback" aria-live="polite"></div>
    </div>
  </div>

  <script>
    // Elementos
    const senhaEl = document.getElementById('senha');
    const gerarBtn = document.getElementById('gerarBtn');
    const copiarBtn = document.getElementById('copiarBtn');
    const tamanhoRange = document.getElementById('tamanho');
    const tamanhoValor = document.getElementById('tamanhoValor');
    const maiusculas = document.getElementById('maiusculas');
    const minusculas = document.getElementById('minusculas');
    const numeros = document.getElementById('numeros');
    const simbolos = document.getElementById('simbolos');
    const semAmbiguos = document.getElementById('semAmbiguos');
    const barraForca = document.getElementById('barraForca');
    const feedback = document.getElementById('feedback');

    // Conjuntos de caracteres
    const LOWER = 'abcdefghijklmnopqrstuvwxyz';
    const UPPER = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
    const DIGITS = '0123456789';
    const SYMBOLS = '!@#$%^&*()-_=+[]{};:,.<>/?|~`';

    const AMBIGUOUS = '0O1lI';

    // Atualiza valor exibido do tamanho
    tamanhoRange.addEventListener('input', () => {
      tamanhoValor.textContent = tamanhoRange.value;
    });

    // Gerar senha
    function gerarSenha() {
      const length = parseInt(tamanhoRange.value, 10);
      let pool = '';
      if (maiusculas.checked) pool += UPPER;
      if (minusculas.checked) pool += LOWER;
      if (numeros.checked) pool += DIGITS;
      if (simbolos.checked) pool += SYMBOLS;

      if (!pool) {
        senhaEl.textContent = 'Selecione pelo menos um conjunto de caracteres';
        senhaEl.classList.add('error');
        updateStrength(0);
        return '';
      }

      // remover ambíguos
      if (semAmbiguos.checked) {
        pool = pool.split('').filter(c => !AMBIGUOUS.includes(c)).join('');
      }

      // Geração robusta: usa window.crypto se disponível
      const array = new Uint32Array(length);
      window.crypto.getRandomValues(array);
      let senha = '';
      for (let i = 0; i < length; i++) {
        const idx = array[i] % pool.length;
        senha += pool.charAt(idx);
      }

      senhaEl.textContent = senha;
      senhaEl.classList.remove('error');
      updateStrength(scorePassword(senha));
      feedback.textContent = '';
      return senha;
    }

    // Copiar para a área de transferência com feedback
    copiarBtn.addEventListener('click', async () => {
      const texto = senhaEl.textContent;
      if (!texto || texto === 'Clique em Gerar' || texto.startsWith('Selecione')) return;
      try {
        await navigator.clipboard.writeText(texto);
        feedback.textContent = 'Copiado!';
        feedback.className = 'copied';
        setTimeout(() => { feedback.textContent = ''; }, 2000);
      } catch (err) {
        feedback.textContent = 'Falha ao copiar';
        feedback.className = 'error';
        console.error('Erro copiar:', err);
      }
    });

    // Botão gerar
    gerarBtn.addEventListener('click', gerarSenha);

    // Força da senha (simples heurística)
    function scorePassword(pwd) {
      let score = 0;
      if (!pwd) return 0;
      // comprimento
      score += Math.min(10, pwd.length) * 4;
      // variedade de classes
      const classes = [
        /[a-z]/.test(pwd),
        /[A-Z]/.test(pwd),
        /[0-9]/.test(pwd),
        /[^A-Za-z0-9]/.test(pwd)
      ];
      score += classes.filter(Boolean).length * 10;
      // penaliza sequências simples
      if (/(012|123|234|345|456|567|678|789|abc|bcd|cde|def)/i.test(pwd)) score -= 10;
      // penaliza repetições
      if (/(.)\1\1/.test(pwd)) score -= 10;
      // normaliza entre 0 e 100
      score = Math.max(0, Math.min(100, score));
      return score;
    }

    function updateStrength(score) {
      barraForca.style.width = score + '%';
      // ajusta cor dinamicamente (inline style)
      if (score < 30) barraForca.style.background = 'linear-gradient(90deg,#ff6b6b,#ffb4a2)';
      else if (score < 60) barraForca.style.background = 'linear-gradient(90deg,#ffd166,#ffe8a8)';
      else barraForca.style.background = 'linear-gradient(90deg,#9bff9b,#6aeb6a)';
    }

    // Gera uma senha inicial quando abrir
    window.addEventListener('load', () => {
      gerarSenha();
    });

    // Atalho: Enter para gerar, Ctrl+C para copiar (quando foco não estiver em input)
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        if (document.activeElement.tagName !== 'INPUT') gerarSenha();
      }
    });
  </script>
</body>
</html>
